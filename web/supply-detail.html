<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>供应详情 - 农产品供销信息平台</title>
    <!-- 网站描述 -->
    <meta name="description" content="农产品供销信息平台供应详情，查看供应商的具体供应信息">
    <!-- 关键词 -->
    <meta name="keywords" content="农产品,供应详情,农产品供应,供销平台">
    <!-- 主题色 -->
    <meta name="theme-color" content="#2E8B57">

    <!-- 引入字体图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- 引入自定义样式 -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- 详情页专用样式 -->
    <link rel="stylesheet" href="css/supply-detail.css">
    <!-- 预加载关键资源 -->
    <link rel="preload" href="https://img.icons8.com/color/96/null/natural-food.png" as="image">
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preload" href="js/main.js" as="script">
</head>

<body>
    <!-- Web应用布局 -->
    <div class="web-layout">
        <!-- 顶部导航栏 -->
        <header class="web-header">
            <!-- 水平导航菜单 - 包含logo和用户图标 -->
            <nav class="horizontal-nav">
                <div class="horizontal-nav-menu">
                    <!-- 添加logo到导航栏 -->
                    <div class="logo">
                        <img src="https://img.icons8.com/color/96/null/natural-food.png" alt="农产品供销信息平台">
                        <span class="logo-text">农产品供销平台</span>
                    </div>

                    <!-- 中间导航链接 -->
                    <div class="nav-links">
                        <div class="horizontal-nav-item">
                            <a href="index.html" class="horizontal-nav-link">
                                <i class="fas fa-home"></i>
                                <span>首页</span>
                            </a>
                        </div>
                        <div class="horizontal-nav-item active">
                            <a href="javascript:void(0)" class="horizontal-nav-link" id="trade-hall-link">
                                <i class="fas fa-building"></i>
                                <span>交易大厅</span>
                            </a>
                        </div>
                        <div class="horizontal-nav-item">
                            <a href="publish.html" class="horizontal-nav-link">
                                <i class="fas fa-edit"></i>
                                <span>发布信息</span>
                            </a>
                        </div>

                        <div class="nav-group-divider"></div>

                        <div class="horizontal-nav-item">
                            <a href="policy.html" class="horizontal-nav-link">
                                <i class="fas fa-newspaper"></i>
                                <span>消息快报</span>
                            </a>
                        </div>
                    </div>

                    <!-- 添加用户图标到导航栏 -->
                    <div class="header-icons">
                        <div class="role-switch" onclick="showRoleModal(); return false;">
                            <i class="fas fa-exchange-alt"></i>
                            <span id="currentRole">采购商</span>
                        </div>
                        <a href="user.html" class="avatar-wrapper">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="用户头像">
                        </a>
                    </div>
                </div>
            </nav>

            <!-- 顶部区域 - 仅保留搜索 -->
            <div class="header-top">
                <!-- 移动端显示的logo -->
                <div class="logo mobile-logo">
                    <img src="https://img.icons8.com/color/96/null/natural-food.png" alt="农产品供销信息平台">
                    <span class="logo-text">农产品供销平台</span>
                </div>

                <div class="search-wrapper">
                    <form class="search-form">
                        <i class="fas fa-search search-icon"></i>
                        <input type="search" class="search-input" placeholder="搜索农产品、种类、地区...">
                        <button type="button" class="advanced-search-toggle">
                            <i class="fas fa-sliders-h"></i>
                        </button>
                    </form>
                </div>

                <!-- 移动端菜单按钮 -->
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- 面包屑导航 -->
                <div class="breadcrumb">
                    <div class="breadcrumb-item">
                        <a href="index.html">首页</a>
                    </div>
                    <div class="breadcrumb-item">
                        <a href="supply.html">供应大厅</a>
                    </div>
                    <div class="breadcrumb-item">
                        <a href="supply-detail.html">供应详情</a>
                    </div>
                </div>

                <!-- 供应详情内容 -->
                <div class="detail-container">
                    <div class="detail-header">
                        <h1 class="detail-title">山东烟台红富士苹果 现货供应</h1>
                        <div class="detail-meta">
                            <span class="detail-time"><i class="far fa-clock"></i> 发布时间: 2023-10-12</span>
                            <span class="detail-views"><i class="far fa-eye"></i> 浏览: 478</span>
                            <span class="detail-area"><i class="fas fa-map-marker-alt"></i> 山东省烟台市</span>
                        </div>
                        <div class="detail-actions">
                            <button class="btn-detail-action btn-favorite" onclick="toggleFavorite(1)">
                                <i class="far fa-heart"></i> 收藏
                            </button>
                            <button class="btn-detail-action btn-report" onclick="showReportModal()">
                                <i class="fas fa-flag"></i> 举报
                            </button>
                        </div>
                    </div>

                    <div class="detail-content">
                        <div class="product-gallery">
                            <div class="gallery-main">
                                <img src="https://source.unsplash.com/800x600/?apple,fruit" alt="红富士苹果" id="mainImage">
                            </div>
                            <div class="gallery-thumbs">
                                <div class="thumb-item active">
                                    <img src="https://source.unsplash.com/800x600/?apple,fruit" alt="红富士苹果-1"
                                        onclick="changeMainImage(this.src)">
                                </div>
                                <div class="thumb-item">
                                    <img src="https://source.unsplash.com/800x600/?red+apple" alt="红富士苹果-2"
                                        onclick="changeMainImage(this.src)">
                                </div>
                                <div class="thumb-item">
                                    <img src="https://source.unsplash.com/800x600/?apple+orchard" alt="红富士苹果-3"
                                        onclick="changeMainImage(this.src)">
                                </div>
                            </div>
                        </div>

                        <div class="detail-info">
                            <div class="info-item">
                                <span class="info-label">供应价格</span>
                                <span class="info-value price-value">¥6.5/斤</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">最小起订</span>
                                <span class="info-value">100斤</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">供货能力</span>
                                <span class="info-value">10000斤/天</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">产品分类</span>
                                <span class="info-value">水果 > 苹果</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">供应商类型</span>
                                <span class="info-value">果园基地</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">支付方式</span>
                                <span class="info-value">预付30%，货到付清</span>
                            </div>
                        </div>

                        <div class="detail-description">
                            <h3 class="section-title">产品详情</h3>
                            <div class="description-content">
                                <p>烟台红富士苹果是我国苹果中的精品，色泽红艳，果肉脆甜多汁，香气浓郁。我们的苹果来自山东烟台产区核心地带，种植于海拔300米以上的山地果园，昼夜温差大，光照充足，果实品质极佳。
                                </p>
                                <p>产品规格：</p>
                                <ul>
                                    <li>品种：红富士</li>
                                    <li>规格：75-80mm(中果)、80-90mm(大果)</li>
                                    <li>等级：一级果，表面光洁，色泽均匀</li>
                                    <li>包装：纸箱/泡沫箱，净重10kg/箱</li>
                                    <li>保质期：常温保存1个月，冷藏可达3个月</li>
                                </ul>
                                <p>供货说明：</p>
                                <ul>
                                    <li>现货供应，下单后24小时内发货</li>
                                    <li>物流方式：可选择快递或物流公司</li>
                                    <li>大量采购可提供产地直发服务</li>
                                    <li>支持门店、超市配送合作</li>
                                </ul>
                                <p>欢迎各大批发商、超市、水果店前来采购，量大价优！</p>
                            </div>
                        </div>

                        <div class="contact-info">
                            <h3 class="section-title">联系方式</h3>
                            <div class="contact-content">
                                <div class="contact-item">
                                    <i class="fas fa-user"></i>
                                    <span class="contact-label">联系人：</span>
                                    <span class="contact-value">李经理</span>
                                </div>
                                <div class="contact-item">
                                    <i class="fas fa-building"></i>
                                    <span class="contact-label">公司名称：</span>
                                    <span class="contact-value">烟台市******果业有限公司</span>
                                </div>
                            </div>
                            <div class="contact-buttons">
                                <button class="btn-contact btn-phone" data-contact-type="phone" data-company-id="1">
                                    <i class="fas fa-phone"></i> 联系电话
                                </button>
                                <button class="btn-contact btn-wechat" data-contact-type="wechat" data-company-id="1">
                                    <i class="fab fa-weixin"></i> 微信号
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 相关推荐 -->
                <div class="related-products">
                    <h3 class="section-title">相关供应</h3>
                    <div class="product-grid">
                        <div class="product-card">
                            <div class="product-image">
                                <img src="https://source.unsplash.com/300x300/?vegetable,organic" alt="有机蔬菜">
                                <span class="product-tag supply-tag">供应</span>
                            </div>
                            <div class="product-info">
                                <h4 class="product-title"><a href="supply-detail.html?id=2">有机蔬菜礼盒装 绿色健康</a></h4>
                                <div class="product-price">¥168/箱</div>
                                <div class="product-meta">
                                    <span class="product-location"><i class="fas fa-map-marker-alt"></i> 江苏省南京市</span>
                                    <span class="product-time">2天前</span>
                                </div>
                            </div>
                        </div>

                        <div class="product-card">
                            <div class="product-image">
                                <img src="https://source.unsplash.com/300x300/?kiwi,fruit" alt="猕猴桃">
                                <span class="product-tag supply-tag">供应</span>
                            </div>
                            <div class="product-info">
                                <h4 class="product-title"><a href="supply-detail.html?id=4">陕西眉县猕猴桃</a></h4>
                                <div class="product-price">¥89/10斤</div>
                                <div class="product-meta">
                                    <span class="product-location"><i class="fas fa-map-marker-alt"></i> 陕西省宝鸡市</span>
                                    <span class="product-time">1天前</span>
                                </div>
                            </div>
                        </div>

                        <div class="product-card">
                            <div class="product-image">
                                <img src="https://source.unsplash.com/300x300/?mushroom" alt="东北黑木耳">
                                <span class="product-tag supply-tag">供应</span>
                            </div>
                            <div class="product-info">
                                <h4 class="product-title"><a href="supply-detail.html?id=5">东北特产黑木耳</a></h4>
                                <div class="product-price">¥28/袋</div>
                                <div class="product-meta">
                                    <span class="product-location"><i class="fas fa-map-marker-alt"></i> 吉林省长春市</span>
                                    <span class="product-time">3天前</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 页脚区域 -->
        <div id="footer-container"></div>

        <!-- 返回按钮 -->
        <div class="back-button" title="返回供应列表">
            <i class="fas fa-arrow-left"></i>
            返回列表
        </div>

        <!-- 移动端底部导航 -->
        <div class="mobile-nav" style="display: none;">
            <a href="index.html" class="mobile-nav-item">
                <i class="fas fa-home"></i>
                <span>首页</span>
            </a>
            <a href="supply.html" class="mobile-nav-item active">
                <i class="fas fa-store"></i>
                <span>供应</span>
            </a>
            <a href="publish.html" class="mobile-nav-item">
                <div class="publish-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <span>发布</span>
            </a>
            <a href="demand.html" class="mobile-nav-item">
                <i class="fas fa-shopping-cart"></i>
                <span>需求</span>
            </a>
            <a href="user.html" class="mobile-nav-item">
                <i class="fas fa-user"></i>
                <span>我的</span>
            </a>
        </div>

        <!-- 返回顶部按钮 -->
        <div class="back-to-top">
            <i class="fas fa-arrow-up"></i>
        </div>

        <!-- 角色切换模态框 -->
        <div class="role-modal" id="roleModal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>切换角色</h3>
                    <button type="button" class="close-btn" id="roleModalCloseBtn" onclick="closeRoleModal()"><i
                            class="fas fa-times"></i></button>
                </div>
                <div class="modal-body">
                    <div class="role-options">
                        <div class="role-option" data-role="采购商" onclick="selectRoleOption(this)">
                            <i class="fas fa-shopping-cart"></i>
                            <div class="role-option-info">
                                <h4>采购商</h4>
                                <p>发布农产品采购需求</p>
                            </div>
                        </div>
                        <div class="role-option" data-role="供应商" onclick="selectRoleOption(this)">
                            <i class="fas fa-store"></i>
                            <div class="role-option-info">
                                <h4>供应商</h4>
                                <p>发布农产品供应信息</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-confirm" id="roleModalConfirmBtn"
                        onclick="confirmRoleChange()">确认切换</button>
                </div>
            </div>
        </div>

        <!-- 联系方式模态框 -->
        <div class="role-modal contact-modal" id="contactModal" style="z-index: 2000; display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="contactModalTitle">联系供应商</h3>
                    <button class="close-btn" id="contactModalCloseBtn"><i class="fas fa-times"></i></button>
                </div>
                <div class="modal-body">
                    <div class="contact-info">
                        <div class="company-profile">
                            <img src="images/avatar/company1.jpg" alt="公司头像" id="modalCompanyAvatar"
                                class="modal-company-avatar">
                            <div class="company-details">
                                <h4 id="modalCompanyName">烟台市阳光果业有限公司</h4>
                            </div>
                        </div>
                        <div class="contact-method" id="phoneContactMethod">
                            <h4>联系电话</h4>
                            <div class="contact-value-wrapper">
                                <p class="contact-value hidden-value" id="phoneValue">***********</p>
                                <div class="loading-spinner" id="phoneLoadingSpinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <span>申请审核中</span>
                                </div>
                            </div>
                            <p class="contact-note">联系时请说明来自"农产品供销平台"</p>
                        </div>
                        <div class="contact-method" id="wechatContactMethod">
                            <h4>微信号</h4>
                            <div class="contact-value-wrapper">
                                <p class="contact-value hidden-value" id="wechatValue">***********</p>
                                <div class="loading-spinner" id="wechatLoadingSpinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <span>申请审核中</span>
                                </div>
                            </div>
                            <p class="contact-note">添加微信时请说明来自"农产品供销平台"</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <p class="privacy-note"><i class="fas fa-shield-alt"></i> 平台保障用户隐私安全</p>
                </div>
            </div>
        </div>

        <!-- 举报模态框 -->
        <div class="role-modal report-modal" id="reportModal" style="z-index: 2000; display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>举报信息</h3>
                    <button class="close-btn" onclick="closeReportModal()"><i class="fas fa-times"></i></button>
                </div>
                <div class="modal-body">
                    <div class="report-form">
                        <div class="report-type">
                            <h4>举报类型</h4>
                            <div class="report-options">
                                <label class="report-option">
                                    <input type="radio" name="reportType" value="fake">
                                    <span>虚假信息</span>
                                </label>
                                <label class="report-option">
                                    <input type="radio" name="reportType" value="price">
                                    <span>价格异常</span>
                                </label>
                                <label class="report-option">
                                    <input type="radio" name="reportType" value="quality">
                                    <span>质量问题</span>
                                </label>
                                <label class="report-option">
                                    <input type="radio" name="reportType" value="scam">
                                    <span>诈骗/欺诈</span>
                                </label>
                                <label class="report-option">
                                    <input type="radio" name="reportType" value="other">
                                    <span>其他问题</span>
                                </label>
                            </div>
                        </div>
                        <div class="report-detail">
                            <h4>问题描述</h4>
                            <textarea placeholder="请详细描述您遇到的问题..." maxlength="500"></textarea>
                            <div class="text-count">0/500</div>
                        </div>
                        <div class="report-upload">
                            <h4>上传凭证（选填）</h4>
                            <div class="upload-area">
                                <i class="fas fa-camera"></i>
                                <span>添加图片</span>
                                <input type="file" accept="image/*" multiple>
                            </div>
                            <div class="upload-preview"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeReportModal()">取消</button>
                    <button type="button" class="btn-submit" onclick="submitReport()">提交</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入JavaScript文件 -->
    <script src="js/main.js"></script>
    <script src="js/components.js"></script>
    <script src="js/role-switch.js"></script>
    <script src="js/trade-hall.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 加载页脚组件
            loadComponent('footer-container', 'components/footer.html');

            // 获取URL参数
            const urlParams = new URLSearchParams(window.location.search);
            const supplyId = urlParams.get('id') || '1'; // 默认显示ID为1的供应

            // 更新当前角色
            updateCurrentRole();

            // 添加收藏按钮交互
            const favoriteBtn = document.querySelector('.btn-favorite');
            if (favoriteBtn) {
                // 检查是否已收藏
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                if (favorites.includes('supply-' + supplyId)) {
                    favoriteBtn.innerHTML = '<i class="fas fa-heart"></i> 已收藏';
                    favoriteBtn.classList.add('favorited');
                }
            }

            // 记录浏览历史
            saveViewHistory(supplyId);

            // 返回顶部按钮
            const backToTopBtn = document.querySelector('.back-to-top');
            if (backToTopBtn) {
                window.addEventListener('scroll', function () {
                    if (window.pageYOffset > 300) {
                        backToTopBtn.classList.add('show');
                    } else {
                        backToTopBtn.classList.remove('show');
                    }
                });

                backToTopBtn.addEventListener('click', function () {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // 联系模态框功能
            initContactModal();

            // 监听返回按钮
            const backButton = document.querySelector('.back-button');
            if (backButton) {
                backButton.addEventListener('click', function () {
                    // 尝试获取之前的页面，如果是从supply.html来的，则返回
                    if (document.referrer.includes('supply.html')) {
                        window.history.back();
                    } else {
                        // 如果不是从supply.html来的，则直接跳转到supply.html
                        window.location.href = 'supply.html';
                    }
                });
            }
        });

        // 更新当前角色
        function updateCurrentRole() {
            const currentRole = localStorage.getItem('userRole') || '采购商';
            const currentRoleSpan = document.getElementById('currentRole');
            if (currentRoleSpan) {
                currentRoleSpan.textContent = currentRole;
            }
        }

        // 切换收藏状态
        function toggleFavorite(id) {
            const isGuest = localStorage.getItem('isGuest') === 'true';
            if (isGuest) {
                alert('访客模式下无法收藏，请先登录');
                return;
            }

            const favoriteBtn = document.querySelector('.btn-favorite');
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const itemId = 'supply-' + id;

            if (favorites.includes(itemId)) {
                // 取消收藏
                const index = favorites.indexOf(itemId);
                favorites.splice(index, 1);
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i> 收藏';
                favoriteBtn.classList.remove('favorited');
                alert('已取消收藏');
            } else {
                // 添加收藏
                favorites.push(itemId);
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i> 已收藏';
                favoriteBtn.classList.add('favorited');
                alert('已添加到收藏');
            }

            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        // 联系供应商
        function contactSupplier(id) {
            const isGuest = localStorage.getItem('isGuest') === 'true';
            if (isGuest) {
                alert('访客模式下无法联系供应商，请先登录');
                return;
            }

            // 显示联系模态框
            const contactModal = document.getElementById('contactModal');
            if (contactModal) {
                contactModal.classList.add('active');
                contactModal.style.display = 'flex';

                // 重置联系方式视图
                resetContactView();

                // 显示电话联系方式，隐藏微信联系方式
                document.getElementById('wechatContactMethod').style.display = 'none';

                // 模拟加载延迟
                setTimeout(function () {
                    const phoneLoadingSpinner = document.getElementById('phoneLoadingSpinner');
                    const phoneValue = document.getElementById('phoneValue');

                    if (phoneLoadingSpinner) {
                        phoneLoadingSpinner.style.display = 'none';
                    }

                    if (phoneValue) {
                        phoneValue.textContent = '13912345678';
                        phoneValue.classList.remove('hidden-value');
                        phoneValue.style.display = 'block';
                        phoneValue.style.color = 'var(--text-primary)';
                        phoneValue.style.textShadow = 'none';
                    }
                }, 800);
            } else {
                alert('即将联系供应商，商品ID: ' + id);
            }
        }

        // 显示联系信息
        function showContactInfo() {
            const isGuest = localStorage.getItem('isGuest') === 'true';
            if (isGuest) {
                alert('访客模式下无法查看完整联系方式，请先登录');
                return;
            }

            const contactItems = document.querySelectorAll('.contact-value');
            contactItems[1].textContent = '13912345678';
            contactItems[2].textContent = '烟台市阳光果业有限公司';

            document.querySelector('.btn-show-contact').style.display = 'none';
        }

        // 显示分享选项
        function showShareOptions() {
            alert('分享功能开发中...');
            // 实际应用中应该显示分享选项
        }

        // 更换主图
        function changeMainImage(src) {
            document.getElementById('mainImage').src = src;

            // 更新缩略图选中状态
            const thumbs = document.querySelectorAll('.thumb-item');
            thumbs.forEach(thumb => {
                if (thumb.querySelector('img').src === src) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // 保存浏览历史
        function saveViewHistory(id) {
            // 跳过访客模式
            if (localStorage.getItem('isGuest') === 'true') {
                return;
            }

            const history = JSON.parse(localStorage.getItem('viewHistory') || '[]');
            const itemId = 'supply-' + id;

            // 如果已存在，则移除旧记录
            const index = history.findIndex(item => item.id === itemId);
            if (index > -1) {
                history.splice(index, 1);
            }

            // 添加到历史记录开头
            history.unshift({
                id: itemId,
                title: document.querySelector('.detail-title').textContent,
                price: document.querySelector('.price-value').textContent,
                image: document.getElementById('mainImage').src,
                time: new Date().toISOString()
            });

            // 限制历史记录数量
            if (history.length > 50) {
                history.pop();
            }

            localStorage.setItem('viewHistory', JSON.stringify(history));
        }

        // 初始化联系模态框
        function initContactModal() {
            // 获取模态框和相关元素
            const contactModal = document.getElementById('contactModal');
            const closeModalBtn = document.getElementById('contactModalCloseBtn');

            if (!contactModal) return;

            // 重置联系方式显示
            resetContactView();

            // 初始化联系按钮点击事件
            const contactButtons = document.querySelectorAll('.btn-contact');
            contactButtons.forEach(btn => {
                btn.addEventListener('click', function (e) {
                    e.preventDefault();

                    // 获取公司ID和联系方式类型
                    const companyId = this.getAttribute('data-company-id');
                    const contactType = this.getAttribute('data-contact-type');

                    if (!companyId || !contactType) {
                        console.error('无效的公司ID或联系方式类型');
                        return;
                    }

                    // 模拟公司数据
                    const companyData = {
                        "1": {
                            name: "烟台市阳光果业有限公司",
                            avatar: "images/avatar/company1.jpg",
                            phone: "13912345678",
                            wechatId: "YTFruit888"
                        }
                    };

                    // 更新公司信息
                    const companyName = document.getElementById('modalCompanyName');
                    const companyAvatar = document.getElementById('modalCompanyAvatar');

                    if (companyName) companyName.textContent = companyData[companyId].name;
                    if (companyAvatar) companyAvatar.src = companyData[companyId].avatar;

                    // 显示模态框
                    contactModal.classList.add('active');
                    contactModal.style.display = 'flex';

                    // 重置联系方式视图
                    resetContactView();

                    // 根据类型显示不同的联系方式
                    if (contactType === 'phone') {
                        document.getElementById('wechatContactMethod').style.display = 'none'; // 隐藏微信联系方式

                        // 模拟加载延迟
                        setTimeout(function () {
                            const phoneLoadingSpinner = document.getElementById('phoneLoadingSpinner');
                            const phoneValue = document.getElementById('phoneValue');

                            if (phoneLoadingSpinner) {
                                phoneLoadingSpinner.style.display = 'none';
                            }

                            if (phoneValue) {
                                phoneValue.textContent = companyData[companyId].phone;
                                phoneValue.classList.remove('hidden-value');
                                phoneValue.style.display = 'block';
                                phoneValue.style.color = 'var(--text-primary)';
                                phoneValue.style.textShadow = 'none';
                            }
                        }, 800);
                    } else if (contactType === 'wechat') {
                        document.getElementById('phoneContactMethod').style.display = 'none'; // 隐藏电话联系方式

                        // 模拟加载延迟
                        setTimeout(function () {
                            const wechatLoadingSpinner = document.getElementById('wechatLoadingSpinner');
                            const wechatValue = document.getElementById('wechatValue');

                            if (wechatLoadingSpinner) {
                                wechatLoadingSpinner.style.display = 'none';
                            }

                            if (wechatValue) {
                                wechatValue.textContent = companyData[companyId].wechatId;
                                wechatValue.classList.remove('hidden-value');
                                wechatValue.style.display = 'block';
                                wechatValue.style.color = 'var(--text-primary)';
                                wechatValue.style.textShadow = 'none';
                            }
                        }, 800);
                    }
                });
            });

            // 关闭模态框
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', function () {
                    contactModal.classList.remove('active');
                    contactModal.style.display = 'none';
                });
            }

            // 点击模态框背景关闭
            contactModal.addEventListener('click', function (e) {
                if (e.target === this) {
                    contactModal.classList.remove('active');
                    contactModal.style.display = 'none';
                }
            });
        }

        // 重置联系方式显示
        function resetContactView() {
            const phoneWrapper = document.getElementById('phoneContactMethod');
            const wechatWrapper = document.getElementById('wechatContactMethod');
            const phoneValue = document.getElementById('phoneValue');
            const wechatValue = document.getElementById('wechatValue');
            const phoneLoadingSpinner = document.getElementById('phoneLoadingSpinner');
            const wechatLoadingSpinner = document.getElementById('wechatLoadingSpinner');

            if (!phoneWrapper || !wechatWrapper) return;

            phoneWrapper.style.display = 'block';
            wechatWrapper.style.display = 'block';

            if (phoneLoadingSpinner) {
                phoneLoadingSpinner.style.display = 'flex';
            }

            if (wechatLoadingSpinner) {
                wechatLoadingSpinner.style.display = 'flex';
            }

            if (phoneValue) {
                phoneValue.style.display = 'none';
                phoneValue.classList.add('hidden-value');
                phoneValue.style.textShadow = '0 0 6px rgba(0, 0, 0, 0.5)';
                phoneValue.style.color = 'transparent';
                phoneValue.textContent = '***********';
            }

            if (wechatValue) {
                wechatValue.style.display = 'none';
                wechatValue.classList.add('hidden-value');
                wechatValue.style.textShadow = '0 0 6px rgba(0, 0, 0, 0.5)';
                wechatValue.style.color = 'transparent';
                wechatValue.textContent = '***********';
            }
        }

        // 举报功能相关代码
        function showReportModal() {
            const modal = document.getElementById('reportModal');
            modal.style.display = 'flex';
            modal.classList.add('active');
        }

        function closeReportModal() {
            const modal = document.getElementById('reportModal');
            modal.classList.remove('active');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        function submitReport() {
            const reportType = document.querySelector('input[name="reportType"]:checked');
            const reportDetail = document.querySelector('.report-detail textarea');

            if (!reportType) {
                alert('请选择举报类型');
                return;
            }

            if (!reportDetail.value.trim()) {
                alert('请填写问题描述');
                return;
            }

            // 这里添加举报提交逻辑
            alert('举报已提交，我们会尽快处理');
            closeReportModal();
        }

        // 文本计数功能
        document.querySelector('.report-detail textarea').addEventListener('input', function () {
            const count = this.value.length;
            document.querySelector('.text-count').textContent = `${count}/500`;
        });

        // 图片上传预览
        document.querySelector('.upload-area input[type="file"]').addEventListener('change', function () {
            const preview = document.querySelector('.upload-preview');
            preview.innerHTML = '';

            Array.from(this.files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        preview.appendChild(img);
                    }
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>

    <style>
        /* 举报按钮样式 */
        .btn-report {
            background-color: #fff;
            border: 1px solid #ddd;
            color: #666;
            margin-left: 10px;
        }

        .btn-report:hover {
            background-color: #f5f5f5;
        }

        /* 举报模态框样式 */
        .report-modal .modal-content {
            max-width: 480px;
            width: 90%;
        }

        .report-form {
            padding: 15px 0;
        }

        .report-type h4,
        .report-detail h4,
        .report-upload h4 {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
        }

        .report-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .report-option {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .report-option input[type="radio"] {
            margin-right: 8px;
        }

        .report-option:hover {
            background-color: #f5f5f5;
        }

        .report-detail textarea {
            width: 100%;
            height: 120px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: none;
            margin-bottom: 5px;
        }

        .text-count {
            text-align: right;
            color: #999;
            font-size: 12px;
        }

        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .upload-area i {
            font-size: 24px;
            color: #999;
            margin-bottom: 8px;
        }

        .upload-area span {
            display: block;
            color: #666;
        }

        .upload-area input[type="file"] {
            display: none;
        }

        .upload-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .upload-preview img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .btn-cancel {
            padding: 8px 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #fff;
            color: #666;
        }

        .btn-submit {
            padding: 8px 20px;
            border: none;
            border-radius: 4px;
            background: var(--primary-color);
            color: #fff;
        }

        .btn-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
    </style>
</body>

</html>