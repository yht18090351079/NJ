<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>发布信息 - 农产品供销信息平台</title>
    <!-- 引入字体图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- 引入自定义样式 -->
    <link rel="stylesheet" href="css/style.css">
    <!-- 页面描述 -->
    <meta name="description" content="发布农产品供应或采购需求信息">
    <!-- 主题色 -->
    <meta name="theme-color" content="#2E8B57">
    <style>
        /* 发布页面特有样式 */
        .type-selector {
            display: flex;
            margin: var(--spacing-lg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            background-color: var(--white);
        }

        .type-option {
            flex: 1;
            text-align: center;
            padding: var(--spacing-md) 0;
            font-size: var(--font-size-base);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .type-option.active {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .type-option:not(.active):hover {
            background-color: rgba(46, 139, 87, 0.1);
            color: var(--primary-color);
        }

        .publish-options {
            padding: var(--spacing-md);
            background: #f8f9fa;
        }

        .publish-grid {
            display: grid;
            gap: var(--spacing-md);
        }

        .publish-item {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border-color);
        }

        .publish-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .publish-item i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: var(--spacing-sm);
        }

        .publish-item h3 {
            font-size: var(--font-size-md);
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
        }

        .publish-item p {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
            font-size: var(--font-size-sm);
            line-height: 1.5;
        }

        .publish-item .publish-btn {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-xl);
            background-color: var(--primary-color);
            color: var(--white);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .publish-item .publish-btn:hover {
            background-color: #236b4a;
            transform: translateY(-1px);
        }

        /* 表单样式优化 */
        .form-card {
            background-color: var(--white);
            margin: 0 var(--spacing-lg) var(--spacing-lg);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.3s ease;
        }

        .form-card:hover {
            box-shadow: var(--shadow-md);
        }

        .form-title {
            font-size: var(--font-size-md);
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            display: flex;
            align-items: center;
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .form-title i {
            color: var(--primary-color);
            margin-right: var(--spacing-sm);
        }

        .form-group {
            margin-bottom: var(--spacing-lg);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            font-weight: 500;
        }

        .required::after {
            content: '*';
            color: #F44336;
            margin-left: 4px;
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            color: var(--text-primary);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(46, 139, 87, 0.2);
            outline: none;
        }

        .form-help {
            font-size: var(--font-size-xs);
            color: var(--text-tertiary);
            margin-top: var(--spacing-xs);
        }

        .form-select {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            color: var(--text-primary);
            background-color: var(--white);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(46, 139, 87, 0.2);
            outline: none;
        }

        .radio-group {
            display: flex;
            gap: var(--spacing-md);
        }

        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .radio-input {
            margin-right: var(--spacing-xs);
        }

        .tags-input {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            min-height: 48px;
            align-items: center;
            transition: border-color 0.3s ease;
        }

        .tags-input:focus-within {
            border-color: var(--primary-color);
        }

        .tag {
            display: flex;
            align-items: center;
            background-color: #E8F5E9;
            color: var(--primary-color);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            transition: background-color 0.3s ease;
        }

        .tag:hover {
            background-color: #C8E6C9;
        }

        .tag i {
            margin-left: var(--spacing-xs);
            font-size: 10px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .tag i:hover {
            opacity: 1;
        }

        .tag-input {
            flex: 1;
            min-width: 100px;
            border: none;
            outline: none;
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            background: transparent;
        }

        .images-upload {
            padding: var(--spacing-md);
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            text-align: center;
            transition: border-color 0.3s ease;
        }

        .images-upload:hover {
            border-color: var(--primary-color);
        }

        .upload-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-sm) var(--spacing-lg);
            background-color: #F5F5F5;
            color: var(--text-secondary);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            margin-bottom: var(--spacing-sm);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .upload-btn:hover {
            background-color: #E0E0E0;
            color: var(--text-primary);
        }

        .upload-btn i {
            margin-right: var(--spacing-sm);
        }

        .upload-desc {
            font-size: var(--font-size-xs);
            color: var(--text-tertiary);
        }

        .preview-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-md);
        }

        .preview-item {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: var(--radius-sm);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-remove {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 20px;
            height: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .preview-remove:hover {
            background-color: rgba(0, 0, 0, 0.7);
        }

        .textarea {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            color: var(--text-primary);
            min-height: 100px;
            resize: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(46, 139, 87, 0.2);
            outline: none;
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: var(--spacing-md) 0;
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            border-radius: var(--radius-lg);
            font-size: var(--font-size-md);
            font-weight: bold;
            margin-top: var(--spacing-xl);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .submit-btn:hover {
            background-color: #236b4a;
        }

        .template-card {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-md);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .template-card:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        .template-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: #E8F5E9;
            color: var(--primary-color);
            border-radius: var(--radius-sm);
            margin-right: var(--spacing-md);
        }

        .template-info {
            flex-grow: 1;
        }

        .template-title {
            font-size: var(--font-size-sm);
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .template-desc {
            font-size: var(--font-size-xs);
            color: var(--text-tertiary);
        }

        .template-use {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--primary-color);
            border-radius: var(--radius-md);
            color: var(--primary-color);
            font-size: var(--font-size-xs);
            background-color: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-use:hover {
            background-color: var(--primary-color);
            color: var(--white);
        }

        /* 发布按钮样式 */
        .nav-publish .publish-btn {
            width: 56px;
            height: 56px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: -28px;
            box-shadow: 0 2px 8px rgba(46, 139, 87, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .nav-publish .publish-btn i {
            font-size: 24px;
            color: var(--white);
            margin: 0;
        }

        .nav-publish .publish-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 139, 87, 0.4);
        }

        .nav-publish .publish-btn:active {
            transform: translateY(0);
        }

        .nav-publish span {
            margin-top: 4px;
        }

        /* 历史发布区域样式 */
        .history-section {
            padding: var(--spacing-md);
            background-color: #f8f9fa;
            min-height: calc(100vh - 200px);
        }

        .section-header {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
        }

        .header-left {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .header-left h2 {
            font-size: var(--font-size-lg);
            color: var(--text-primary);
            margin: 0;
            font-weight: 600;
        }

        .header-right {
            width: 100%;
        }

        .header-right .publish-btn {
            padding: var(--spacing-xs) var(--spacing-lg);
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-sm);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            height: 32px;
        }

        .header-right .publish-btn i {
            font-size: var(--font-size-sm);
        }

        .header-right .publish-btn:hover {
            background-color: var(--primary-color);
            color: var(--white);
            transform: translateY(-1px);
        }

        .status-filter {
            display: flex;
            gap: var(--spacing-xs);
            width: 100%;
            margin-top: var(--spacing-md);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE and Edge */
            padding-bottom: 4px;
            /* 为了避免滚动条 */
        }

        .status-filter::-webkit-scrollbar {
            display: none;
            /* Chrome, Safari and Opera */
        }

        .status-btn {
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--white);
            color: var(--text-secondary);
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            white-space: normal;
            flex: 0 0 auto;
            min-width: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .status-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: rgba(46, 139, 87, 0.05);
        }

        .status-btn.active {
            background: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
            font-weight: 500;
        }

        .status-btn .count {
            font-size: 12px;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            display: block;
        }

        .status-btn:hover .count {
            opacity: 1;
        }

        .status-btn.active .count {
            opacity: 1;
            color: inherit;
        }

        .waterfall-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: var(--spacing-md);
            padding: var(--spacing-sm);
            min-height: 200px;
            position: relative;
        }

        .post-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .post-card.hidden {
            display: none;
        }

        .post-card.fade-out {
            opacity: 0;
            transform: scale(0.95) translateY(10px);
            pointer-events: none;
        }

        .post-card.fade-in {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .no-results {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: var(--text-tertiary);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .no-results.show {
            opacity: 1;
            pointer-events: auto;
        }

        .no-results i {
            font-size: 48px;
            margin-bottom: var(--spacing-sm);
            opacity: 0.5;
        }

        .no-results p {
            font-size: var(--font-size-sm);
        }

        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .post-image {
            position: relative;
            height: 160px;
            overflow: hidden;
            background: #f5f5f5;
        }

        .post-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .post-card:hover .post-image img {
            transform: scale(1.05);
        }

        .post-status {
            position: absolute;
            top: var(--spacing-xs);
            right: var(--spacing-xs);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            color: var(--white);
            font-weight: 500;
            backdrop-filter: blur(4px);
        }

        .post-status.active {
            background: rgba(46, 139, 87, 0.9);
        }

        .post-status.inactive {
            background: rgba(108, 117, 125, 0.9);
        }

        .post-status.reviewing {
            background: rgba(255, 152, 0, 0.9);
        }

        .post-content {
            padding: var(--spacing-sm);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .post-content h3 {
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .post-content .price {
            font-size: var(--font-size-md);
            color: #F44336;
            font-weight: bold;
            margin-bottom: var(--spacing-xs);
        }

        .post-content .location {
            font-size: var(--font-size-xs);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .post-actions {
            display: flex;
            gap: var(--spacing-xs);
            margin-top: auto;
        }

        .action-btn {
            flex: 1;
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--white);
            color: var(--text-secondary);
            font-size: var(--font-size-xs);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
            min-width: 0;
        }

        .action-btn.edit:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background: rgba(46, 139, 87, 0.05);
        }

        .action-btn.delete:hover {
            background-color: #FFEBEE;
            color: #D32F2F;
        }

        .action-btn.offline {
            color: #F57C00;
        }

        .action-btn.offline:hover {
            background-color: #FFF3E0;
            color: #EF6C00;
        }

        .action-btn.online {
            color: #43A047;
        }

        .action-btn.online:hover {
            background-color: #E8F5E9;
            color: #2E7D32;
        }

        .action-btn i {
            font-size: var(--font-size-xs);
        }

        /* 矩形按钮样式 */
        .rect-btn {
            padding: 6px 16px;
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            border-radius: 4px;
            font-size: var(--font-size-sm);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
            height: 32px;
        }

        .rect-btn:hover {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .rect-btn i {
            font-size: var(--font-size-sm);
        }

        /* 按钮涟漪效果 */
        .status-btn {
            position: relative;
            overflow: hidden;
        }

        .ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 120%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%) scale(0);
            border-radius: 50%;
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple {
            to {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
            }
        }

        /* 角色切换模态框样式 */
        .role-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .role-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .role-modal-content {
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            width: 90%;
            max-width: 320px;
        }

        .role-modal-content h3 {
            text-align: center;
            margin-bottom: var(--spacing-lg);
            color: var(--text-primary);
        }

        .role-options {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .role-option {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .role-option.active {
            border-color: var(--primary-color);
            background-color: #E8F5E9;
        }

        .role-option i {
            font-size: 24px;
            margin-right: var(--spacing-md);
            color: var(--text-tertiary);
        }

        .role-option.active i {
            color: var(--primary-color);
        }

        .role-info h4 {
            margin-bottom: var(--spacing-xs);
            color: var(--text-primary);
        }

        .role-info p {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .role-modal-footer {
            margin-top: var(--spacing-lg);
            text-align: center;
        }

        .role-confirm {
            background-color: var(--primary-color);
            color: var(--white);
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            border: none;
            cursor: pointer;
        }

        /* 角色切换按钮样式 */
        .role-switch {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            background: var(--white);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            box-shadow: var(--shadow-sm);
        }

        .role-switch:active {
            transform: scale(0.95);
        }

        .role-switch span {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .role-switch i {
            font-size: var(--font-size-sm);
            color: var(--primary-color);
        }

        /* 在发布表单页面隐藏底部导航栏 */
        body[data-page="publish-form"] .bottom-navbar {
            display: none;
        }

        /* 在发布表单页面调整内容区域 */
        body[data-page="publish-form"] .page-content {
            padding-bottom: 0;
            min-height: 100vh;
        }

        /* 采购商发布卡片样式 */
        .buyer-item .post-content {
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            background: var(--white);
        }

        .buyer-item .post-status {
            position: relative;
            display: inline-block;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-xs);
            color: var(--white);
            font-weight: 500;
            margin-bottom: var(--spacing-sm);
        }

        .buyer-item .post-status.active {
            background: rgba(46, 139, 87, 0.9);
        }

        .buyer-item .post-status.inactive {
            background: rgba(108, 117, 125, 0.9);
        }

        .buyer-item .post-status.reviewing {
            background: rgba(255, 152, 0, 0.9);
        }

        .buyer-item h3 {
            font-size: var(--font-size-md);
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            line-height: 1.4;
        }

        .buyer-item .price {
            font-size: var(--font-size-lg);
            color: #F44336;
            font-weight: bold;
            margin-bottom: var(--spacing-xs);
        }

        .buyer-item .location {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        /* 应用通用模态框样式 */
        .app-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .app-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
        }

        .app-modal-content {
            position: relative;
            background-color: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            width: 90%;
            max-width: 320px;
            text-align: center;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
            margin: auto;
        }

        .app-modal.active .app-modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .app-modal-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--spacing-md);
        }

        .app-modal-icon.confirm {
            background-color: #FFF3E0;
        }

        .app-modal-icon.confirm i {
            color: #F57C00;
            font-size: 24px;
        }

        .app-modal-title {
            font-size: var(--font-size-lg);
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .app-modal-message {
            font-size: var(--font-size-base);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .app-modal-buttons {
            display: flex;
            gap: var(--spacing-sm);
        }

        .app-modal-btn {
            flex: 1;
            padding: var(--spacing-sm) 0;
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .app-modal-btn.cancel {
            background-color: #F5F5F5;
            color: var(--text-secondary);
        }

        .app-modal-btn.confirm {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .app-modal-btn:hover {
            transform: translateY(-1px);
        }

        .app-modal-btn:active {
            transform: translateY(0);
        }

        .app-modal-icon.delete {
            background-color: #FFEBEE;
            color: #F44336;
        }

        .app-modal-btn.delete {
            background-color: #F44336;
            color: white;
        }

        .app-modal-btn.delete:hover {
            background-color: #D32F2F;
        }
    </style>
</head>

<body>
    <!-- 手机框容器 -->
    <div class="phone-container">
        <!-- 页面内容区域 -->
        <div class="page-content">
            <!-- 顶部导航栏 -->
            <header class="top-navbar">
                <div class="container flex-between">
                    <!-- 返回按钮 -->
                    <a href="javascript:history.back()">
                        <i class="fas fa-arrow-left"></i>
                    </a>

                    <!-- 标题 -->
                    <h1 id="pageTitle">发布信息</h1>

                    <!-- 角色切换 -->
                    <div class="role-switch">
                        <span id="currentRole">供应商</span>
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                </div>
            </header>

            <!-- 角色切换模态框 -->
            <div class="role-modal">
                <div class="role-modal-content">
                    <h3>切换角色</h3>
                    <div class="role-options">
                        <div class="role-option active" data-role="supplier">
                            <i class="fas fa-store"></i>
                            <div class="role-info">
                                <h4>供应商</h4>
                                <p>发布农产品供应信息</p>
                            </div>
                        </div>
                        <div class="role-option" data-role="buyer">
                            <i class="fas fa-shopping-cart"></i>
                            <div class="role-info">
                                <h4>采购商</h4>
                                <p>发布农产品采购需求</p>
                            </div>
                        </div>
                    </div>
                    <div class="role-modal-footer">
                        <button class="role-confirm">确认切换</button>
                    </div>
                </div>
            </div>

            <!-- 主要内容区 -->
            <main class="main-content">
                <!-- 发布类型选择区 -->
                <section class="type-selector-section" style="padding: var(--spacing-md);">
                    <div class="type-selector">
                        <div id="supplyOption" class="type-option active" data-type="supply">我要卖</div>
                        <div id="demandOption" class="type-option" data-type="demand">我要买</div>
                    </div>
                </section>

                <!-- 历史发布信息 -->
                <section class="history-section">
                    <div class="section-header">
                        <div class="header-left">
                            <h2 id="historyTitle">我的发布</h2>
                            <a href="javascript:void(0)" id="publishNewBtn" class="rect-btn">
                                <i class="fas fa-plus"></i> <span id="publishBtnText">立即发布</span>
                            </a>
                        </div>
                        <div class="status-filter">
                            <button class="status-btn active" data-status="all">全部</button>
                            <button class="status-btn" data-status="active">展示中</button>
                            <button class="status-btn" data-status="reviewing">审核中</button>
                            <button class="status-btn" data-status="inactive">已下架</button>
                        </div>
                    </div>
                    <div class="waterfall-grid">
                        <!-- 供应商发布的供应信息 -->
                        <div class="post-card supplier-item" data-status="reviewing">
                            <div class="post-image"
                                onclick="window.location.href='supply-detail.html?status=reviewing'">
                                <img src="images/product5.jpg" alt="新鲜水果">
                                <div class="post-status reviewing">审核中</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=reviewing'"
                                    style="cursor: pointer;">优质柑橘供应
                                </h3>
                                <p class="price">¥4.5/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 四川省成都市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card supplier-item" data-status="active">
                            <div class="post-image" onclick="window.location.href='supply-detail.html?status=active'">
                                <img src="images/product1.jpg" alt="优质大米">
                                <div class="post-status active">展示中</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=active'"
                                    style="cursor: pointer;">优质大米供应
                                </h3>
                                <p class="price">¥3.5/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 湖南省长沙市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card supplier-item" data-status="active">
                            <div class="post-image" onclick="window.location.href='supply-detail.html?status=active'">
                                <img src="images/product2.jpg" alt="新鲜蔬菜">
                                <div class="post-status active">展示中</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=active'"
                                    style="cursor: pointer;">新鲜蔬菜供应
                                </h3>
                                <p class="price">¥2.8/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 山东省潍坊市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card supplier-item" data-status="active">
                            <div class="post-image" onclick="window.location.href='supply-detail.html?status=active'">
                                <img src="images/product3.jpg" alt="新鲜蔬菜">
                                <div class="post-status active">展示中</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=active'"
                                    style="cursor: pointer;">绿色有机蔬菜
                                </h3>
                                <p class="price">¥4.2/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 山东省青岛市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <!-- 采购商发布的需求信息 -->
                        <div class="post-card buyer-item" data-status="active" style="display: none;">
                            <div class="post-content" onclick="window.location.href='demand-detail.html?status=active'"
                                style="cursor: pointer;">
                                <div class="post-status active">展示中</div>
                                <h3>求购优质红薯</h3>
                                <p class="price">¥2.5-3.2/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 湖北省武汉市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card buyer-item" data-status="active" style="display: none;">
                            <div class="post-content" onclick="window.location.href='demand-detail.html?status=active'"
                                style="cursor: pointer;">
                                <div class="post-status active">展示中</div>
                                <h3>采购各类淡水鱼</h3>
                                <p class="price">¥12-15/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 江苏省南京市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <!-- 已下架的发布信息 -->
                        <div class="post-card supplier-item" data-status="inactive">
                            <div class="post-image" onclick="window.location.href='supply-detail.html?status=inactive'">
                                <img src="images/product4.jpg" alt="特级茶叶">
                                <div class="post-status inactive">已下架</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=inactive'"
                                    style="cursor: pointer;">明前龙井茶
                                </h3>
                                <p class="price">¥280/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 浙江省杭州市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn online"><i class="fas fa-arrow-up"></i> 上架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card buyer-item" data-status="inactive" style="display: none;">
                            <div class="post-content"
                                onclick="window.location.href='demand-detail.html?status=inactive'"
                                style="cursor: pointer;">
                                <div class="post-status inactive">已下架</div>
                                <h3>采购有机蔬菜</h3>
                                <p class="price">¥8-10/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 北京市朝阳区</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn online"><i class="fas fa-arrow-up"></i> 上架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>

                        <div class="post-card supplier-item" data-status="active">
                            <div class="post-image" onclick="window.location.href='supply-detail.html?status=active'">
                                <img src="images/product6.jpg" alt="水产">
                                <div class="post-status active">展示中</div>
                            </div>
                            <div class="post-content">
                                <h3 onclick="window.location.href='supply-detail.html?status=active'"
                                    style="cursor: pointer;">淡水鱼批发
                                </h3>
                                <p class="price">¥12/斤</p>
                                <p class="location"><i class="fas fa-map-marker-alt"></i> 江苏省苏州市</p>
                                <div class="post-actions">
                                    <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                    <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                    <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <!-- 底部导航栏 -->
        <nav class="bottom-navbar">
            <div class="nav-items">
                <a href="index.html" class="nav-item" data-page="home">
                    <i class="fas fa-home"></i>
                    <span>首页</span>
                </a>
                <a href="demand.html" class="nav-item" id="marketLink" data-page="market">
                    <i class="fas fa-clipboard-list"></i>
                    <span id="marketText">需求大厅</span>
                </a>
                <a href="publish.html" class="nav-item nav-publish active" data-page="publish">
                    <div class="publish-btn">
                        <i class="fas fa-plus"></i>
                    </div>
                    <span>发布</span>
                </a>
                <a href="policy.html" class="nav-item" data-page="policy">
                    <i class="fas fa-newspaper"></i>
                    <span>消息快报</span>
                </a>
                <a href="user.html" class="nav-item" data-page="user">
                    <i class="fas fa-user"></i>
                    <span>个人中心</span>
                </a>
            </div>
        </nav>

        <!-- 引入主JavaScript文件 -->
        <script src="js/main.js"></script>
        <!-- 引入应用程序交互脚本 -->
        <script src="js/app.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // 检查当前页面是否是发布表单页面
                const currentPage = window.location.pathname.split('/').pop();
                if (currentPage === 'publish-supply.html' || currentPage === 'publish-demand.html') {
                    document.body.setAttribute('data-page', 'publish-form');
                }

                // 从localStorage获取用户角色
                let currentRole = localStorage.getItem('userRole') || 'supplier';
                console.log("初始角色:", currentRole);

                // 获取底部导航栏的市场链接和文本元素
                const marketLink = document.getElementById('marketLink');
                const marketText = document.getElementById('marketText');
                const publishNewBtn = document.getElementById('publishNewBtn');
                const pageTitle = document.getElementById('pageTitle');
                const historyTitle = document.getElementById('historyTitle');
                const publishBtnText = document.getElementById('publishBtnText');

                // 根据当前角色初始化市场链接
                if (marketLink && marketText) {
                    if (currentRole === 'supplier') {
                        marketLink.href = 'demand.html';
                        marketText.textContent = '需求大厅';
                    } else {
                        marketLink.href = 'supply.html';
                        marketText.textContent = '供应大厅';
                    }
                }

                // 根据角色设置"立即发布"按钮链接
                if (publishNewBtn) {
                    publishNewBtn.addEventListener('click', function () {
                        if (currentRole === 'supplier') {
                            window.location.href = 'publish-supply.html';
                        } else {
                            window.location.href = 'publish-demand.html';
                        }
                    });
                }

                // 获取类型选择器元素
                const typeSelector = document.querySelector('.type-selector');
                const supplyOption = document.getElementById('supplyOption');
                const demandOption = document.getElementById('demandOption');

                // 根据角色设置显示内容
                if (currentRole === 'supplier') {
                    if (pageTitle) pageTitle.textContent = '我要卖';
                    if (historyTitle) historyTitle.textContent = '我的供应';
                    if (publishBtnText) publishBtnText.textContent = '发布供应';

                    if (supplyOption) {
                        supplyOption.classList.add('active');
                        supplyOption.textContent = '我要卖';
                    }
                    if (demandOption) {
                        demandOption.classList.remove('active');
                        demandOption.style.display = 'none';
                    }
                    if (typeSelector) {
                        typeSelector.style.display = 'none'; // 供应商只能卖
                    }
                } else {
                    if (pageTitle) pageTitle.textContent = '我要买';
                    if (historyTitle) historyTitle.textContent = '我的需求';
                    if (publishBtnText) publishBtnText.textContent = '发布需求';

                    if (supplyOption) {
                        supplyOption.classList.remove('active');
                        supplyOption.style.display = 'none';
                    }
                    if (demandOption) {
                        demandOption.classList.add('active');
                        demandOption.textContent = '我要买';
                    }
                    if (typeSelector) {
                        typeSelector.style.display = 'none'; // 采购商只能买
                    }
                }

                // 根据角色显示/隐藏发布选项
                const supplierOnly = document.querySelector('.supplier-only');
                const buyerOnly = document.querySelector('.buyer-only');

                if (supplierOnly && buyerOnly) {
                    if (currentRole === 'supplier') {
                        supplierOnly.style.display = 'block';
                        buyerOnly.style.display = 'none';
                    } else {
                        supplierOnly.style.display = 'none';
                        buyerOnly.style.display = 'block';
                    }
                }

                // 表单类型切换
                const typeOptions = document.querySelectorAll('.type-option');
                const supplyForm = document.getElementById('supplyForm');
                const demandForm = document.getElementById('demandForm');

                typeOptions.forEach(option => {
                    option.addEventListener('click', function () {
                        // 移除所有active状态
                        typeOptions.forEach(opt => opt.classList.remove('active'));

                        // 添加当前选项的active状态
                        this.classList.add('active');

                        // 切换表单显示
                        const type = this.getAttribute('data-type');
                        if (type === 'supply') {
                            if (supplyForm) supplyForm.style.display = 'block';
                            if (demandForm) demandForm.style.display = 'none';
                        } else {
                            if (supplyForm) supplyForm.style.display = 'none';
                            if (demandForm) demandForm.style.display = 'block';
                        }
                    });
                });

                // 默认显示对应角色的表单
                if (supplyForm && demandForm) {
                    if (currentRole === 'supplier') {
                        supplyForm.style.display = 'block';
                        demandForm.style.display = 'none';
                    } else {
                        supplyForm.style.display = 'none';
                        demandForm.style.display = 'block';
                    }
                }

                // 标签输入处理
                const tagInputs = document.querySelectorAll('.tag-input');
                tagInputs.forEach(input => {
                    input.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter' && this.value.trim() !== '') {
                            e.preventDefault();

                            const tagsContainer = this.closest('.tags-input');
                            const tagsCount = tagsContainer.querySelectorAll('.tag').length;

                            // 限制最多5个标签
                            if (tagsCount < 5) {
                                const tag = document.createElement('div');
                                tag.className = 'tag';
                                tag.innerHTML = this.value.trim() + ' <i class="fas fa-times"></i>';

                                // 插入新标签
                                tagsContainer.insertBefore(tag, this);

                                // 清空输入框
                                this.value = '';

                                // 添加删除标签的点击事件
                                tag.querySelector('i').addEventListener('click', function () {
                                    tag.remove();
                                });
                            } else {
                                alert('最多添加5个标签');
                            }
                        }
                    });
                });

                // 删除标签点击事件
                document.querySelectorAll('.tag i').forEach(icon => {
                    icon.addEventListener('click', function () {
                        this.parentElement.remove();
                    });
                });

                // 图片上传按钮点击事件
                const uploadBtns = document.querySelectorAll('.upload-btn');
                uploadBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        alert('图片上传功能将在实际应用中实现');
                    });
                });

                // 预览图删除按钮点击事件
                const previewRemoveBtns = document.querySelectorAll('.preview-remove');
                previewRemoveBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        this.closest('.preview-item').remove();
                    });
                });

                // 模板使用按钮点击事件
                const templateUseBtns = document.querySelectorAll('.template-use');
                templateUseBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        const templateName = this.closest('.template-card').querySelector('.template-title').textContent;
                        alert(`将使用模板: ${templateName}`);
                    });
                });

                // 阻止操作按钮的点击事件冒泡
                document.querySelectorAll('.post-actions').forEach(actions => {
                    actions.addEventListener('click', function (e) {
                        e.stopPropagation();
                    });
                });

                // 表单提交处理
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.addEventListener('submit', function (e) {
                        e.preventDefault();

                        // 这里可以添加表单验证逻辑

                        alert('信息提交成功，等待审核');
                        window.location.href = 'index.html';
                    });
                });

                // 获取所有状态按钮和帖子卡片
                const statusBtns = document.querySelectorAll('.status-btn');
                const postCards = document.querySelectorAll('.post-card');
                const supplierItems = document.querySelectorAll('.supplier-item');
                const buyerItems = document.querySelectorAll('.buyer-item');
                const waterfall = document.querySelector('.waterfall-grid');

                // 状态按钮点击事件
                statusBtns.forEach(btn => {
                    btn.addEventListener('click', function () {
                        // 移除所有按钮的active状态
                        statusBtns.forEach(b => b.classList.remove('active'));
                        // 添加当前按钮的active状态
                        this.classList.add('active');
                        // 获取选中的状态
                        const status = this.getAttribute('data-status');
                        // 执行筛选
                        filterPosts(status);
                    });
                });

                // 筛选函数
                function filterPosts(status) {
                    let visibleCount = 0;
                    let visibleCards = [];

                    // 先获取当前角色下应该显示的卡片
                    if (currentRole === 'supplier') {
                        visibleCards = Array.from(supplierItems);
                    } else {
                        visibleCards = Array.from(buyerItems);
                    }

                    // 先将所有卡片隐藏并添加淡出效果
                    visibleCards.forEach(card => {
                        card.classList.add('fade-out');
                        setTimeout(() => {
                            card.classList.add('hidden');
                            const cardStatus = card.getAttribute('data-status');
                            if (status === 'all' || cardStatus === status) {
                                visibleCount++;
                                card.classList.remove('hidden');
                                card.classList.remove('fade-out');
                                card.classList.add('fade-in');
                            }
                        }, 300);
                    });

                    // 更新无结果提示的显示状态
                    setTimeout(() => {
                        const noResults = document.querySelector('.no-results');
                        if (noResults) {
                            if (visibleCount === 0) {
                                noResults.classList.add('show');
                            } else {
                                noResults.classList.remove('show');
                            }
                        }
                    }, 350);
                }

                // 更新按钮文本和数量，分别计算供应商和采购商的数量
                function updateStatusCounts() {
                    const visibleItems = currentRole === 'supplier' ? supplierItems : buyerItems;
                    const statusCounts = {
                        all: Array.from(visibleItems).filter(card => !card.classList.contains('hidden')).length,
                        reviewing: Array.from(visibleItems).filter(card => card.getAttribute('data-status') === 'reviewing').length,
                        active: Array.from(visibleItems).filter(card => card.getAttribute('data-status') === 'active').length,
                        inactive: Array.from(visibleItems).filter(card => card.getAttribute('data-status') === 'inactive').length
                    };

                    // 更新按钮文本和数量
                    statusBtns.forEach(btn => {
                        const status = btn.getAttribute('data-status');
                        const count = statusCounts[status] || 0;
                        // 先移除之前的数量
                        const countSpan = btn.querySelector('.count');
                        if (countSpan) countSpan.remove();

                        const statusText = btn.textContent.split('(')[0].trim();
                        btn.innerHTML = `${statusText}<span class="count">${count}</span>`;
                    });
                }

                // 初始化显示对应角色的帖子
                updatePostsByRole(currentRole);

                // 初始化状态筛选为"全部"
                filterPosts('all');

                // 根据角色显示/隐藏发布选项
                function updatePostsByRole(role) {
                    if (role === 'supplier') {
                        supplierItems.forEach(item => {
                            item.style.display = '';
                        });
                        buyerItems.forEach(item => {
                            item.style.display = 'none';
                        });
                    } else {
                        supplierItems.forEach(item => {
                            item.style.display = 'none';
                        });
                        buyerItems.forEach(item => {
                            item.style.display = '';
                        });
                    }

                    // 重新初始化筛选
                    if (statusBtns.length > 0) {
                        // 获取当前选中的状态
                        const activeBtn = document.querySelector('.status-btn.active');
                        if (activeBtn) {
                            const status = activeBtn.getAttribute('data-status');
                            filterPosts(status);
                        } else {
                            filterPosts('all');
                        }
                    }
                }

                // 初始化角色切换
                const roleSwitch = document.querySelector('.role-switch');
                const roleModal = document.querySelector('.role-modal');
                const roleOptions = document.querySelectorAll('.role-option');
                const roleConfirm = document.querySelector('.role-confirm');
                const currentRoleText = document.getElementById('currentRole');

                // 更新UI显示
                function updateRoleUI(role) {
                    // 更新角色文本和市场链接
                    currentRoleText.textContent = role === 'supplier' ? '供应商' : '采购商';
                    marketText.textContent = role === 'supplier' ? '需求大厅' : '供应大厅';
                    marketLink.href = role === 'supplier' ? 'demand.html' : 'supply.html';

                    // 更新页面标题和按钮文本
                    if (pageTitle) pageTitle.textContent = role === 'supplier' ? '我要卖' : '我要买';
                    if (historyTitle) historyTitle.textContent = role === 'supplier' ? '我的供应' : '我的需求';
                    if (publishBtnText) publishBtnText.textContent = role === 'supplier' ? '发布供应' : '发布需求';

                    // 更新角色选项的激活状态
                    roleOptions.forEach(option => {
                        option.classList.toggle('active', option.dataset.role === role);
                    });

                    // 更新图片上传区域的显示/隐藏
                    const imageUploadAreas = document.querySelectorAll('.images-upload');
                    imageUploadAreas.forEach(area => {
                        area.style.display = role === 'supplier' ? 'block' : 'none';
                    });

                    // 更新类型选择器
                    if (supplyOption && demandOption) {
                        if (role === 'supplier') {
                            supplyOption.classList.add('active');
                            supplyOption.style.display = '';
                            demandOption.classList.remove('active');
                            demandOption.style.display = 'none';
                        } else {
                            supplyOption.classList.remove('active');
                            supplyOption.style.display = 'none';
                            demandOption.classList.add('active');
                            demandOption.style.display = '';
                        }
                    }

                    // 更新信息流显示
                    updatePostsByRole(role);

                    // 更新状态计数
                    if (typeof updateStatusCounts === 'function') {
                        updateStatusCounts();
                    }

                    // 更新底部导航高亮
                    updateNavHighlight(role);

                    // 如果角色变化且当前在市场页面，则需要重定向
                    const currentPage = window.location.pathname.split('/').pop().split('.')[0];
                    if (currentPage === 'supply' && role === 'supplier') {
                        window.location.href = 'demand.html';
                    } else if (currentPage === 'demand' && role === 'buyer') {
                        window.location.href = 'supply.html';
                    }
                }

                // 更新底部导航栏高亮
                function updateNavHighlight(role) {
                    const currentPage = window.location.pathname.split('/').pop().split('.')[0];
                    const navItems = document.querySelectorAll('.nav-item');
                    navItems.forEach(item => {
                        const dataPage = item.getAttribute('data-page');
                        if (currentPage === dataPage ||
                            (currentPage === 'policy' && dataPage === 'policy') ||
                            (currentPage === 'demand' && dataPage === 'market' && role === 'supplier') ||
                            (currentPage === 'supply' && dataPage === 'market' && role === 'buyer')) {
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    });
                }

                // 初始化UI
                updateRoleUI(currentRole);

                // 角色切换按钮点击事件
                if (roleSwitch) {
                    roleSwitch.addEventListener('click', () => {
                        console.log("角色切换按钮被点击");
                        // 添加点击效果
                        roleSwitch.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            roleSwitch.style.transform = 'scale(1)';
                        }, 200);

                        // 显示模态框
                        if (roleModal) {
                            roleModal.classList.add('active');
                        }

                        // 根据当前角色预选对应选项
                        roleOptions.forEach(option => {
                            option.classList.toggle('active', option.dataset.role === currentRole);
                        });
                    });
                }

                // 角色选项点击事件
                roleOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        roleOptions.forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                    });
                });

                // 确认按钮点击事件
                if (roleConfirm) {
                    roleConfirm.addEventListener('click', () => {
                        const selectedOption = document.querySelector('.role-option.active');
                        if (selectedOption) {
                            const selectedRole = selectedOption.dataset.role;
                            console.log("选择的新角色:", selectedRole);
                            if (selectedRole !== currentRole) {
                                currentRole = selectedRole;
                                localStorage.setItem('userRole', currentRole);
                                updateRoleUI(currentRole);

                                // 根据角色更新页面内容
                                if (supplierOnly && buyerOnly) {
                                    if (currentRole === 'supplier') {
                                        supplierOnly.style.display = 'block';
                                        buyerOnly.style.display = 'none';
                                    } else {
                                        supplierOnly.style.display = 'none';
                                        buyerOnly.style.display = 'block';
                                    }
                                }

                                // 更新表单显示
                                if (supplyForm && demandForm) {
                                    if (currentRole === 'supplier') {
                                        supplyForm.style.display = 'block';
                                        demandForm.style.display = 'none';
                                    } else {
                                        supplyForm.style.display = 'none';
                                        demandForm.style.display = 'block';
                                    }
                                }
                            }
                        }

                        if (roleModal) {
                            roleModal.classList.remove('active');
                        }
                    });
                }

                // 点击模态框外部关闭
                if (roleModal) {
                    roleModal.addEventListener('click', (e) => {
                        if (e.target === roleModal) {
                            roleModal.classList.remove('active');
                            // 重置选项状态
                            roleOptions.forEach(option => {
                                option.classList.toggle('active', option.dataset.role === currentRole);
                            });
                        }
                    });
                }

                // 为所有操作按钮添加点击事件
                function bindActionButtons() {
                    console.log('Binding action buttons...');

                    // 上架/下架按钮
                    const actionButtons = document.querySelectorAll('.action-btn.offline, .action-btn.online');
                    console.log('Found action buttons:', actionButtons.length);

                    actionButtons.forEach(btn => {
                        // 移除旧的事件监听器
                        btn.removeEventListener('click', handleStatusToggle);
                        // 添加新的事件监听器
                        btn.addEventListener('click', handleStatusToggle);
                    });

                    // 删除按钮
                    document.querySelectorAll('.action-btn.delete').forEach(btn => {
                        btn.removeEventListener('click', handleDelete);
                        btn.addEventListener('click', handleDelete);
                    });

                    // 编辑按钮
                    document.querySelectorAll('.action-btn.edit').forEach(btn => {
                        btn.removeEventListener('click', handleEdit);
                        btn.addEventListener('click', handleEdit);
                    });
                }

                // 处理上架/下架操作
                function handleStatusToggle(e) {
                    e.stopPropagation();
                    console.log('Status toggle clicked');

                    const isOffline = this.classList.contains('offline');
                    const card = this.closest('.post-card');

                    // 移除可能存在的旧弹窗
                    const oldModal = document.getElementById('toggleStatusModal');
                    if (oldModal) {
                        oldModal.remove();
                    }

                    // 创建确认弹窗
                    const modalHtml = `
                        <div class="app-modal" id="toggleStatusModal">
                            <div class="app-modal-content">
                                <div class="app-modal-icon confirm">
                                    <i class="fas fa-exclamation"></i>
                                </div>
                                <h3 class="app-modal-title">确认操作</h3>
                                <p class="app-modal-message">${isOffline ? '确定要下架该商品吗？' : '确定要上架该商品吗？'}</p>
                                <div class="app-modal-buttons">
                                    <button class="app-modal-btn cancel" id="cancelToggleBtn">取消</button>
                                    <button class="app-modal-btn confirm" id="confirmToggleBtn">确认</button>
                                </div>
                            </div>
                        </div>
                    `;

                    // 添加新弹窗到页面
                    document.body.insertAdjacentHTML('beforeend', modalHtml);

                    // 获取新创建的弹窗元素
                    const toggleStatusModal = document.getElementById('toggleStatusModal');
                    const confirmToggleBtn = document.getElementById('confirmToggleBtn');
                    const cancelToggleBtn = document.getElementById('cancelToggleBtn');

                    // 显示弹窗
                    toggleStatusModal.classList.add('active');

                    // 确认按钮点击事件
                    const handleConfirm = function () {
                        const statusDiv = card.querySelector('.post-status');
                        const postActions = card.querySelector('.post-actions');

                        if (isOffline) {
                            // 下架操作
                            card.setAttribute('data-status', 'inactive');
                            statusDiv.className = 'post-status inactive';
                            statusDiv.textContent = '已下架';

                            // 更新按钮组
                            postActions.innerHTML = `
                                <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                <button class="action-btn online"><i class="fas fa-arrow-up"></i> 上架</button>
                                <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                            `;
                        } else {
                            // 上架操作
                            card.setAttribute('data-status', 'active');
                            statusDiv.className = 'post-status active';
                            statusDiv.textContent = '展示中';

                            // 更新按钮组
                            postActions.innerHTML = `
                                <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                <button class="action-btn offline"><i class="fas fa-arrow-down"></i> 下架</button>
                                <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                            `;
                        }

                        // 更新状态计数
                        updateStatusCounts();

                        // 重新绑定按钮事件
                        bindActionButtons();

                        // 如果当前不是在"全部"标签下，则需要重新筛选
                        const activeStatusBtn = document.querySelector('.status-btn.active');
                        if (activeStatusBtn && activeStatusBtn.getAttribute('data-status') !== 'all') {
                            filterPosts(activeStatusBtn.getAttribute('data-status'));
                        }

                        // 关闭并移除弹窗
                        toggleStatusModal.classList.remove('active');
                        setTimeout(() => toggleStatusModal.remove(), 300);
                    };

                    // 绑定确认按钮事件
                    confirmToggleBtn.addEventListener('click', handleConfirm);

                    // 取消按钮点击事件
                    cancelToggleBtn.onclick = function () {
                        toggleStatusModal.classList.remove('active');
                        setTimeout(() => toggleStatusModal.remove(), 300);
                    };

                    // 点击模态框外部关闭
                    toggleStatusModal.onclick = function (e) {
                        if (e.target === toggleStatusModal) {
                            toggleStatusModal.classList.remove('active');
                            setTimeout(() => toggleStatusModal.remove(), 300);
                        }
                    };
                }

                // 处理删除操作
                function handleDelete(e) {
                    e.stopPropagation();
                    const card = this.closest('.post-card');

                    // 显示删除确认弹窗
                    const deleteModal = document.getElementById('deleteConfirmModal');
                    deleteModal.classList.add('active');

                    // 确认删除按钮点击事件
                    const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
                    const handleConfirmDelete = function () {
                        card.style.transition = 'all 0.3s ease';
                        card.style.opacity = '0';
                        card.style.transform = 'scale(0.9)';

                        setTimeout(() => {
                            card.remove();
                            updateStatusCounts();

                            const currentItems = currentRole === 'supplier' ?
                                document.querySelectorAll('.supplier-item:not(.hidden)') :
                                document.querySelectorAll('.buyer-item:not(.hidden)');

                            const noResults = document.querySelector('.no-results');
                            if (currentItems.length === 0 && noResults) {
                                noResults.classList.add('show');
                            }
                        }, 300);

                        // 关闭并移除事件监听
                        deleteModal.classList.remove('active');
                        confirmDeleteBtn.removeEventListener('click', handleConfirmDelete);
                    };

                    // 绑定确认删除事件
                    confirmDeleteBtn.addEventListener('click', handleConfirmDelete);

                    // 取消删除按钮点击事件
                    const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
                    cancelDeleteBtn.onclick = function () {
                        deleteModal.classList.remove('active');
                        confirmDeleteBtn.removeEventListener('click', handleConfirmDelete);
                    };

                    // 点击模态框外部关闭
                    deleteModal.onclick = function (e) {
                        if (e.target === deleteModal) {
                            deleteModal.classList.remove('active');
                            confirmDeleteBtn.removeEventListener('click', handleConfirmDelete);
                        }
                    };
                }

                // 处理编辑操作
                function handleEdit(e) {
                    e.stopPropagation();
                    const card = this.closest('.post-card');
                    const isBuyerItem = card.classList.contains('buyer-item');
                    const status = card.getAttribute('data-status');
                    window.location.href = isBuyerItem ?
                        `publish-demand.html?edit=true&status=${status}` :
                        `publish-supply.html?edit=true&status=${status}`;
                }

                // 初始绑定所有按钮事件
                bindActionButtons();

                // 监听DOM变化，重新绑定按钮事件
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList' || mutation.type === 'subtree') {
                            bindActionButtons();
                        }
                    });
                });

                // 观察整个waterfall-grid的变化
                const waterfallGrid = document.querySelector('.waterfall-grid');
                if (waterfallGrid) {
                    observer.observe(waterfallGrid, {
                        childList: true,
                        subtree: true
                    });
                }

                // 更新审核中商品的操作按钮和点击事件
                function updateReviewingItemActions() {
                    const reviewingItems = document.querySelectorAll('.post-card[data-status="reviewing"]');
                    reviewingItems.forEach(item => {
                        // 更新操作按钮
                        const actionsDiv = item.querySelector('.post-actions');
                        if (actionsDiv) {
                            actionsDiv.innerHTML = `
                                <button class="action-btn edit"><i class="fas fa-edit"></i> 编辑</button>
                                <button class="action-btn delete"><i class="fas fa-trash"></i> 删除</button>
                            `;
                        }

                        // 添加图片点击事件
                        const imageDiv = item.querySelector('.post-image');
                        if (imageDiv) {
                            imageDiv.style.cursor = 'pointer';
                            imageDiv.onclick = function () {
                                const isBuyerItem = item.classList.contains('buyer-item');
                                const status = item.getAttribute('data-status');
                                window.location.href = isBuyerItem ?
                                    `demand-detail.html?status=${status}` :
                                    `supply-detail.html?status=${status}`;
                            };
                        }

                        // 添加标题点击事件
                        const titleH3 = item.querySelector('h3');
                        if (titleH3) {
                            titleH3.style.cursor = 'pointer';
                            titleH3.onclick = function () {
                                const isBuyerItem = item.classList.contains('buyer-item');
                                const status = item.getAttribute('data-status');
                                window.location.href = isBuyerItem ?
                                    `demand-detail.html?status=${status}` :
                                    `supply-detail.html?status=${status}`;
                            };
                        }
                    });
                }
            });
        </script>
    </div>

    <!-- 删除确认弹窗 -->
    <div class="app-modal" id="deleteConfirmModal">
        <div class="app-modal-content">
            <div class="app-modal-icon delete">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="app-modal-title">确认删除</div>
            <div class="app-modal-message">确定要删除这条信息吗？删除后将无法恢复。</div>
            <div class="app-modal-buttons">
                <button class="app-modal-btn cancel" id="cancelDeleteBtn">取消</button>
                <button class="app-modal-btn delete" id="confirmDeleteBtn">删除</button>
            </div>
        </div>
    </div>
</body>

</html>